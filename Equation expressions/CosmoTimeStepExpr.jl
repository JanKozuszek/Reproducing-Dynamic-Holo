function DtX(S,SZ, Sdot,SdotZ, Phidot, A, AZ, z, LN, X, p2, t, DS0, DS1, DS2, DS3, DS4)

XPrime = (135*Power(DS1,7)*Power(LN,3)*Power(M,4)*Power(z,10) + 27*DS0*Power(DS1,5)*Power(LN,3)*Power(M,4)*Power(z,9)*(3*DS2*z + 5*DS1*(-1 + 3*X*z)) + 2*Power(DS0,6)*(540*DS1 + 1080*DConst*DS1*z + 1080*DS2*z + 1080*DS1*X*z - 180*DS1*Power(M,2)*Power(z,2) + 1080*DConst*DS1*X*Power(z,2) + 1080*DS2*X*Power(z,2) + 540*DS1*Power(X,2)*Power(z,2) - 240*DConst*DS1*Power(M,2)*Power(z,3) - 45*DS2*Power(M,2)*Power(z,3) + 720*DS2*LN*Power(M,2)*Power(z,3) - 480*DS1*Power(M,2)*X*Power(z,3) - 1620*A*DS1*Power(z,4) + 90*DConst*DS2*LN*Power(M,2)*Power(z,4) + 100*DS1*Power(M,4)*Power(z,4) + 720*DS1*M*Phidot*Power(z,4) + 540*SdotZ*Power(z,4) - 90*DS2*Power(M,2)*X*Power(z,4) + 810*DS2*LN*Power(M,2)*X*Power(z,4) - 120*DS1*Power(M,2)*Power(X,2)*Power(z,4) - 540*AZ*DS1*Power(z,5) + 30*DS2*Power(M,4)*Power(z,5) - 270*DS2*LN*Power(M,4)*Power(z,5) - 1080*DS2*LN*M*Phidot*Power(z,5) - 1080*A*DS1*X*Power(z,5) + 1080*SdotZ*X*Power(z,5) - 45*DS2*Power(M,2)*Power(X,2)*Power(z,5) + 90*DS2*LN*Power(M,2)*Power(X,2)*Power(z,5) + 120*A*DS1*Power(M,2)*Power(z,6) - 24*DS3*LN*Power(M,4)*Power(z,6) - 80*DS1*Power(M,3)*Phidot*Power(z,6) - 720*DS1*Power(Phidot,2)*Power(z,6) - 360*Power(M,2)*SdotZ*Power(z,6) - 540*AZ*DS1*X*Power(z,6) + 270*DS2*LN*Power(M,4)*X*Power(z,6) - 1080*DS2*LN*M*Phidot*X*Power(z,6) + 540*SdotZ*Power(X,2)*Power(z,6) + 120*AZ*DS1*Power(M,2)*Power(z,7) - 45*A*DS2*Power(M,2)*Power(z,7) + 480*DS2*LN*Power(M,3)*Phidot*Power(z,7) - 45*AZ*DS2*LN*Power(M,2)*Power(z,8) + 96*DS3*LN*Power(M,3)*Phidot*Power(z,8) + 80*DS1*Power(M,2)*Power(Phidot,2)*Power(z,8) + 540*A*SdotZ*Power(z,8) - 720*DS2*LN*Power(M,3)*Phidot*X*Power(z,8) - 120*DS2*LN*Power(M,2)*Power(Phidot,2)*Power(z,9) - 96*DS3*LN*Power(M,2)*Power(Phidot,2)*Power(z,10) + 360*DS2*LN*Power(M,2)*Power(Phidot,2)*X*Power(z,10) - 180*S*Power(z,5)*Power(M - 2*Phidot*Power(z,2),2) - 180*Sdot*Power(z,3)*(-12 - 6*DConst*z - 18*X*z + 4*Power(M,2)*Power(z,2) - 6*Power(X,2)*Power(z,2) + 3*AZ*Power(z,5))) + 9*Power(DS0,2)*Power(DS1,3)*Power(LN,2)*Power(M,2)*Power(z,6)*(-90*DS1*S*Power(z,3) - 27*Power(DS2,2)*LN*Power(M,2)*Power(z,4) - 10*Power(DS1,2)*(9 + Power(M,2)*Power(z,2) - 4*M*Phidot*Power(z,4)) + 3*DS1*LN*Power(M,2)*Power(z,3)*(-4*DS3*z + 15*DS2*(-1 + 3*X*z))) - 60*Power(DS0,7)*(-18*DConst - 36*DConst*X*z + 6*DConst*Power(M,2)*Power(z,2) - 18*DConst*Power(X,2)*Power(z,2) - 2*Power(M,4)*Power(z,3) + 9*AZ*Power(z,4) + 2*Power(M,4)*X*Power(z,4) + 18*AZ*X*Power(z,5) - 3*AZ*Power(M,2)*Power(z,6) + 9*AZ*Power(X,2)*Power(z,6) - 6*A*Power(z,3)*(-6 - 9*X*z + Power(M,2)*Power(z,2) - 3*Power(X,2)*Power(z,2)) - 8*M*Phidot*Power(z,3)*(3 - Power(M,2)*Power(z,2) + X*z*(3 + Power(M,2)*Power(z,2))) + 8*Power(Phidot,2)*Power(z,5)*(3 - Power(M,2)*Power(z,2) + X*z*(3 + Power(M,2)*Power(z,2)))) + 3*Power(DS0,4)*Power(z,2)*(-360*Power(DS1,3) - 80*Power(DS1,3)*Power(M,2)*Power(z,2) + 360*Power(DS1,3)*LN*Power(M,2)*Power(z,2) - 210*Power(DS1,2)*DS2*Power(M,2)*Power(z,3) + 420*Power(DS1,2)*DS2*LN*Power(M,2)*Power(z,3) - 540*Power(DS1,2)*DS2*Power(LN,2)*Power(M,2)*Power(z,3) + 720*Power(DS1,2)*Sdot*Power(z,3) - 270*DS1*Power(DS2,2)*Power(LN,2)*Power(M,2)*Power(z,4) - 20*Power(DS1,3)*LN*Power(M,4)*Power(z,4) - 720*Power(DS1,3)*LN*M*Phidot*Power(z,4) + 360*Power(DS1,2)*SdotZ*Power(z,4) - 540*Power(DS1,2)*DS2*Power(LN,2)*Power(M,2)*X*Power(z,4) + 300*Power(DS1,2)*DS2*Power(LN,2)*Power(M,4)*Power(z,5) + 114*DS1*Power(DS2,2)*Power(LN,2)*Power(M,4)*Power(z,6) + 48*Power(DS1,2)*DS3*Power(LN,2)*Power(M,4)*Power(z,6) - 540*Power(DS1,2)*DS2*Power(LN,2)*Power(M,4)*X*Power(z,6) - 45*Power(DS2,3)*Power(LN,3)*Power(M,4)*Power(z,7) - 240*Power(DS1,2)*DS2*Power(LN,2)*Power(M,3)*Phidot*Power(z,7) - 36*Power(DS2,2)*DS3*Power(LN,3)*Power(M,4)*Power(z,8) - 168*DS1*Power(DS2,2)*Power(LN,2)*Power(M,3)*Phidot*Power(z,8) - 96*Power(DS1,2)*DS3*Power(LN,2)*Power(M,3)*Phidot*Power(z,8) + 80*Power(DS1,3)*LN*Power(M,2)*Power(Phidot,2)*Power(z,8) + 135*Power(DS2,3)*Power(LN,3)*Power(M,4)*X*Power(z,8) + 720*Power(DS1,2)*DS2*Power(LN,2)*Power(M,3)*Phidot*X*Power(z,8) - 90*LN*M*S*Power(z,5)*(3*Power(DS2,2)*LN*M*Power(z,2) - 4*Power(DS1,2)*(M - 2*Phidot*Power(z,2)))) - 6*Power(DS0,5)*Power(z,2)*(2*DS1*DS2*(28*LN*Power(M,2)*Power(Phidot,2)*Power(z,8) + 12*LN*M*Phidot*Power(z,4)*(15 - 4*Power(M,2)*Power(z,2)) - 20*(9 + 2*Power(M,2)*Power(z,2)) + LN*Power(M,2)*Power(z,2)*(-90 + 17*Power(M,2)*Power(z,2))) + 3*DS2*Power(z,3)*(-10*DS2*Power(M,2) + 20*DS2*LN*Power(M,2) + 45*DS2*Power(LN,2)*Power(M,2) + 240*Sdot + 120*SdotZ*z + 45*DS2*Power(LN,2)*Power(M,2)*X*z - 25*DS2*Power(LN,2)*Power(M,4)*Power(z,2) - 8*DS3*Power(LN,2)*Power(M,4)*Power(z,3) + 45*DS2*Power(LN,2)*Power(M,4)*X*Power(z,3) + 20*DS2*Power(LN,2)*Power(M,3)*Phidot*Power(z,4) + 16*DS3*Power(LN,2)*Power(M,3)*Phidot*Power(z,5) - 60*DS2*Power(LN,2)*Power(M,3)*Phidot*X*Power(z,5) - 60*LN*M*S*Power(z,2)*(M - 2*Phidot*Power(z,2))) + 5*Power(DS1,2)*(-36*DConst - 9*Power(M,2)*z + 18*DConst*LN*Power(M,2)*Power(z,2) - 18*Power(M,2)*X*Power(z,2) + 18*LN*Power(M,2)*X*Power(z,2) + 6*Power(M,4)*Power(z,3) + 2*LN*Power(M,4)*Power(z,3) - 9*Power(M,2)*Power(X,2)*Power(z,3) + 18*LN*Power(M,2)*Power(X,2)*Power(z,3) + 18*AZ*Power(z,4) - 18*LN*Power(M,4)*X*Power(z,4) - 9*AZ*LN*Power(M,2)*Power(z,6) + 8*LN*Power(M,2)*Power(Phidot,2)*Power(z,7)*(1 - 3*X*z) - 9*A*Power(z,3)*(-4 + Power(M,2)*Power(z,2)) + 8*LN*M*Phidot*Power(z,3)*(9 + 9*X*z - 4*Power(M,2)*Power(z,2) + 6*Power(M,2)*X*Power(z,3)))) + 9*Power(DS0,3)*DS1*Power(M,2)*Power(z,5)*(-21*Power(DS2,3)*Power(LN,3)*Power(M,2)*Power(z,5) - 4*Power(DS1,2)*DS2*Power(LN,2)*z*(45 - 7*Power(M,2)*Power(z,2) + 4*M*Phidot*Power(z,4)) - 10*Power(DS1,3)*(-3 + 6*LN + 9*Power(LN,2) - 5*Power(LN,2)*Power(M,2)*Power(z,2) + 4*Power(LN,2)*M*Phidot*Power(z,4)*(1 - 3*X*z) + 9*Power(LN,2)*X*z*(1 + Power(M,2)*Power(z,2))) + 3*DS1*DS2*Power(LN,2)*Power(z,4)*(-60*S + LN*Power(M,2)*(-8*DS3*z + 15*DS2*(-1 + 3*X*z)))))/(60. *Power(DS0,5)*z*(9*Power(DS1,2)*(1 - 2*LN)*Power(M,2)*Power(z,4) - 36*Power(DS0,2)*(1 + X*z) + DS0*(72*Sdot*Power(z,4) + 3*Power(z,4)*(DS2*(-1 + 2*LN)*Power(M,2) + 12*SdotZ*z) - 4*DS1*z*(9 + 2*Power(M,2)*Power(z,2)))));

return XPrime;
end;

function DtPhi(Phi, PhiZ, Phidot, A, z, LN, X, XPrime, t, DS0, DS1, DS2, DS3, DS4)

timeder = (3*Power(DS1,4)*(1 - 3*LN)*M*Power(z,2) + 3*DS0*Power(DS1,2)*M*z*(-4*DS1*LN + DS2*(-1 + 3*LN)*z) + 2*Power(DS0,4)*(-2*Power(M,3) + 9*Phi + 6*Phidot - 9*M*Power(X,2) + 3*PhiZ*z + 4*Power(M,3)*X*z + 18*Phi*X*z - 6*M*Power(X,3)*z + 12*M*X*XPrime*z - 6*Power(M,2)*Phi*Power(z,2) + 6*PhiZ*X*Power(z,2) + 9*Phi*Power(X,2)*Power(z,2) - 18*Phi*XPrime*Power(z,2) - 2*Power(M,2)*PhiZ*Power(z,3) + 3*PhiZ*Power(X,2)*Power(z,3) - 6*PhiZ*XPrime*Power(z,3) + 3*A*Power(z,2)*(M - 2*M*X*z + 3*Phi*Power(z,2) + PhiZ*Power(z,3))) + Power(DS0,3)*(6*DS3*LN*M*z + DS2*(-9*M + 30*M*X*z - 18*LN*M*X*z - 2*Power(M,3)*Power(z,2) + 6*LN*Power(M,3)*Power(z,2) - 36*Phi*Power(z,2) + 3*M*Power(X,2)*Power(z,2) - 9*LN*M*Power(X,2)*Power(z,2) - 6*M*XPrime*Power(z,2) + 18*LN*M*XPrime*Power(z,2) - 12*PhiZ*Power(z,3) + 3*A*(1 - 3*LN)*M*Power(z,4))) + Power(DS0,2)*(6*DS1*DS2*LN*M*z + 6*Power(DS2,2)*(-1 + 3*LN)*M*Power(z,2) + Power(DS1,2)*(9*M - 6*M*X*z - 18*LN*M*X*z - 2*Power(M,3)*Power(z,2) + 6*LN*Power(M,3)*Power(z,2) + 18*Phi*Power(z,2) + 3*M*Power(X,2)*Power(z,2) - 9*LN*M*Power(X,2)*Power(z,2) - 6*M*XPrime*Power(z,2) + 18*LN*M*XPrime*Power(z,2) + 6*PhiZ*Power(z,3) + 3*A*(1 - 3*LN)*M*Power(z,4))))/(12. *Power(DS0,4)*z);

return timeder;
end;

function Dta4(X, a4, p2, XPrime, p2Prime, t, DS0, DS1, DS2, DS3, DS4)

a4Prime = (2*((9*DS1*DS2*Power(M,2))/Power(DS0,2) + (2*(6*DS3*Power(M,2) + DS1*(-27*a4 + 4*Power(M,4) - 18*M*p2)))/DS0 - 18*M*p2Prime + (36*DS1*Power(M,2)*Power(X,2))/DS0 + 36*Power(M,2)*X*XPrime))/27.;

return a4Prime;
end;

